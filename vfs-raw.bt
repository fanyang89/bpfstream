#!/usr/bin/env bpftrace

BEGIN
{
  time();
}

kfunc:vfs_open
/comm == "zsh"/
{
  $name = str(args->path->dentry->d_name.name);
  printf("ts=%lld, fn=%s, tid=%d, path='%s'", nsecs, probe, tid, $name);
}

kretfunc:vfs_open
/comm == "zsh"/
{
  printf("ts=%lld, fn=%s, tid=%d, rc=%d", nsecs, probe, retval, tid);
}
